(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}function n(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,n||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:String(n)}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base_url="http://www.sensorly.io/api",this.sensorlyLeadId=this.getSensorlyLeadId(),this.sensorlyToken=this.getSensorlyToken(),this.start=(new Date).getTime(),this.mainInterval=null,this.scrollingTimeValue=0,this.canSendData=!0}var n,a,i;return n=e,a=[{key:"getApiUrl",value:function(e){return this.base_url+e+"?site_token="+this.sensorlyToken}},{key:"getSensorlyToken",value:function(){return document.getElementById("sensorly").getAttribute("data-token")}},{key:"getSensorlyLeadId",value:function(){var e=new URLSearchParams(window.location.search).get("slid");return e&&localStorage.setItem("sl_id",e),null!=e?e:localStorage.getItem("sl_id")}},{key:"init",value:function(){var e=this;if(this.sensorlyLeadId&&this.sensorlyToken){var t=this.getApiUrl("/analytics");this.behaviorTracking(),window.addEventListener("beforeunload",(function(e){var n=new FormData;n.append("data",localStorage.getItem("sl_data")),n.append("lead_id",localStorage.getItem("sl_id")),navigator.sendBeacon(t,n),localStorage.removeItem("sl_data")})),this.mainInterval=setInterval((function(){e.behaviorTracking()}),5e3)}}},{key:"behaviorTracking",value:function(){var e=localStorage.getItem("sl_data"),t=null;null===e?e=[]:t=(e=JSON.parse(localStorage.getItem("sl_data")))[e.length-1],t&&t.pathname!==window.location.pathname&&(this.start=(new Date).getTime(),this.scrollingTimeValue=0);var n={time_on_page:this.timeOnPage(),scrolling_time:this.scrollingTime()};t&&t.pathname===window.location.pathname?e[e.length-1]={pathname:t.pathname,payload:n}:e.push({pathname:window.location.pathname,payload:n}),localStorage.setItem("sl_data",JSON.stringify(e))}},{key:"getUnixTime",value:function(){return(new Date).getTime()}},{key:"timeOnPage",value:function(){return((new Date).getTime()-this.start)/1e3}},{key:"scrollingTime",value:function(){var e=this;return window.addEventListener("scroll",(function(){e.scrollingTimeValue+=1.8})),this.scrollingTimeValue/100}}],a&&t(n.prototype,a),i&&t(n,i),Object.defineProperty(n,"prototype",{writable:!1}),e}();(new a).init()})();